"""
Moon Sign Descriptions for No-Birth-Time Astrology Analysis

This module contains detailed descriptions for Moon signs, including traits,
explanations, emotional strengths, challenges, and self-care advice.
These descriptions are used in the no-birth-time version of the astrology app.
"""

# Dictionary mapping sign names to their numerical index
SIGN_INDEX = {
    "Aries": 1,
    "Taurus": 2,
    "Gemini": 3,
    "Cancer": 4,
    "Leo": 5,
    "Virgo": 6,
    "Libra": 7,
    "Scorpio": 8,
    "Sagittarius": 9,
    "Capricorn": 10,
    "Aquarius": 11,
    "Pisces": 12,
}

# Dictionary mapping numerical index to sign names
SIGN_NAMES = {
    1: "Aries",
    2: "Taurus",
    3: "Gemini",
    4: "Cancer",
    5: "Leo",
    6: "Virgo",
    7: "Libra",
    8: "Scorpio",
    9: "Sagittarius",
    10: "Capricorn",
    11: "Aquarius",
    12: "Pisces",
}

# Comprehensive Moon sign descriptions
MOON_SIGN_DESCRIPTIONS = {
    "Aries": {
        "traits": "Passionate, Spontaneous, Courageous",
        "explanation": "Your Aries Moon ignites emotions with immediacy and fire. Feelings are experienced intensely and acted upon quickly—your heart thrives on authenticity, boldness, and the freedom to pursue what excites you.",
        "emotional_strengths": "Inner Gifts: You tackle emotions head-on, transforming challenges into action. Your bravery helps you confront discomfort directly, while your spontaneity keeps life vibrant. For example, after a disagreement, you're likely to address it openly rather than stewing in silence. When overwhelmed, channeling energy into a sprint, dance session, or a creative project helps you reset and reclaim your spark.",
        "emotional_challenges": "Growth Areas: Impulsivity can lead to reactive outbursts, and patience with slower-paced emotions (like grief or doubt) might feel uncomfortable. For instance, frustration might prompt a sharp comment you later regret. Tip: Pause for three deep breaths before responding to heated moments. Practice letting quieter emotions \"simmer\" without judgment—they hold wisdom too.",
        "actionable_emotional_care": "Self-Care Rituals: Burn off restless energy with high-intensity workouts (e.g., martial arts, trail running) or creative bursts like improvisational art. End the day with a cooling-down ritual—try a cold face wash or sipping peppermint tea to signal calm.\nCommunication Tip: Say, \"I need to tackle this directly to feel at peace,\" to help others understand your forward-focused style.",
        "closing_affirmation": "Your courage lights the way—it fuels honesty, resilience, and a zest for life's adventures. Embrace your fiery heart, but remember: even warriors need moments of rest. Your passion is a gift; let it ignite you without burning you."
    },
    
    "Taurus": {
        "traits": "Steadfast, Sensual, Grounded",
        "explanation": "Your Taurus Moon roots emotions in stability and sensory comfort. Feelings are experienced deeply and slowly—you crave consistency, tangible security, and moments that soothe your body and soul.",
        "emotional_strengths": "Inner Gifts: You offer unwavering loyalty and calm in chaos, making others feel safe. Your patience helps you weather emotional storms, while your love for life's pleasures turns everyday moments into rituals of joy. For example, you might comfort a friend in crisis by cooking their favorite meal or listening without rushing to \"fix\" things. When stressed, reorganizing your space, gardening, or savoring a decadent dessert can recenter you.",
        "emotional_challenges": "Growth Areas: Resistance to change can lead to clinging to situations or relationships past their expiration date. For instance, you might stay in an unfulfilling job for years because \"it's familiar,\" or avoid addressing conflicts to preserve peace. Tip: Practice \"small surrenders\"—try a new route to work or a hobby that nudges you out of routine. When resentments build, write them down and burn the paper as a symbolic release.",
        "actionable_emotional_care": "Self-Care Rituals: Recharge through touch and taste: schedule massages, bake bread from scratch, or wear fabrics that feel luxurious against your skin. Create a \"comfort corner\" with soft blankets, candles, and calming music for emotional resetting.\nCommunication Tip: Say, \"I need time to process this, but I'll come back when I'm ready,\" to honor your pace while reassuring others.",
        "closing_affirmation": "Your steadiness is a sanctuary—for yourself and those you love. Trust your ability to nurture and endure, but remember: growth lives in the spaces between comfort and curiosity. You are both the oak and the soil; stay rooted, but let your branches stretch toward new light."
    },
    
    "Gemini": {
        "traits": "Curious, Expressive, Dynamic",
        "explanation": "Your Gemini Moon processes emotions through lively exchanges and intellectual exploration. Feelings are filtered through a lens of curiosity—you seek mental stimulation, variety, and connection to feel emotionally grounded.",
        "emotional_strengths": "Inner Gifts: You effortlessly shift perspectives, using humor and wit to lighten heavy moods. Your adaptability helps you reframe challenges into learning opportunities. For example, during a conflict, you might crack a joke to ease tension or propose a creative compromise. When feeling stuck, diving into a podcast, book club, or lively debate can reignite your sense of clarity and hope.",
        "emotional_challenges": "Growth Areas: Overthinking emotions or avoiding vulnerability by staying \"in your head\" can create distance from deeper needs. For instance, you might intellectualize sadness (\"Why shouldn't I feel this way?\") instead of letting yourself simply feel. Tip: Set a 5-minute timer daily to sit quietly and observe emotions without analysis—imagine them as clouds passing through your mind's sky.",
        "actionable_emotional_care": "Self-Care Rituals: Channel mental energy into hands-on creativity: try sketching while listening to music, or voice-memo journaling to \"talk out\" feelings. Schedule \"micro-adventures\"—like exploring a new café or trivia night—to satisfy your need for novelty.\nCommunication Tip: Say, \"I'm figuring this out as I talk—thanks for listening,\" to invite patience as you process aloud.",
        "closing_affirmation": "Your quick mind and playful spirit are gifts—they help you connect, adapt, and find joy in unexpected places. Embrace your love of exploration, but remember: stillness can be a teacher, too. You're allowed to pause, breathe, and let your heart catch up with your thoughts."
    },
    
    "Cancer": {
        "traits": "Nurturing, Intuitive, Protective",
        "explanation": "Your Cancer Moon feels deeply and instinctively, like the ebb and flow of tides. Emotions are tied to safety, memory, and the people you cherish—your heart seeks to nurture and be nurtured in return.",
        "emotional_strengths": "Inner Gifts: You're a natural empath, attuned to others' unspoken needs and gifted at creating emotional safe havens. Your loyalty and ability to \"hold space\" make loved ones feel seen and cherished. For example, you might soothe a friend's anxiety by sharing a childhood comfort (like a favorite blanket or recipe) or recall a meaningful moment to remind them they're loved. When overwhelmed, retreating to a cozy space with soft lighting or revisiting nostalgic music can restore your sense of calm.",
        "emotional_challenges": "Growth Areas: Sensitivity can lead to absorbing others' moods or guarding your heart too fiercely. For instance, you might suppress your own needs to avoid \"burdening\" others or cling to past hurts. Tip: Practice a \"compassion cutoff\"—set a 2-minute timer to acknowledge others' feelings, then gently ask yourself, \"What do I need right now?\" Release old wounds by writing a letter (you don't have to send it) to symbolically let go.",
        "actionable_emotional_care": "Self-Care Rituals: Recharge through moon-inspired routines: take evening walks under the sky, sip chamomile tea, or create a \"memory altar\" with photos/heirlooms that spark joy. Use water-based healing—try baths with Epsom salts or simply rinse your hands while visualizing stress flowing away.\nCommunication Tip: Say, \"I need some extra tenderness right now,\" to invite support without over-explaining.",
        "closing_affirmation": "Your capacity to love and protect is a quiet superpower—it heals, connects, and reminds others of life's sweetness. Honor your depth, but remember: even the ocean needs shores. Let your heart be soft and strong, fluid and resilient. You are home, wherever you are."
    },
    
    "Leo": {
        "traits": "Dramatic, Generous, Warm",
        "explanation": "Your Leo Moon radiates emotions with boldness and flair. Feelings are expressed passionately and magnified—your heart thrives on recognition, creativity, and sharing joy with those you love.",
        "emotional_strengths": "Inner Gifts: You uplift others with your infectious enthusiasm and loyalty, turning ordinary moments into celebrations. Your confidence inspires courage in loved ones, and your generosity shines in heartfelt gestures. For example, you might surprise a friend with a personalized playlist to boost their mood or rally coworkers with a pep talk during a tough project. When feeling low, channeling energy into creative outlets (like dancing, painting, or hosting a game night) reignites your inner spark.",
        "emotional_challenges": "Growth Areas: Pride can make criticism feel like a personal attack, and a fear of being overlooked might lead to overcompensating (e.g., dominating conversations or dismissing others' ideas). For instance, you might shut down if a partner forgets to praise your effort. Tip: Practice \"quiet confidence\"—remind yourself of your worth without external validation. Try journaling three small wins weekly, focusing on how they made you feel, not others' reactions.",
        "actionable_emotional_care": "Self-Care Rituals: Recharge through creative play: take an improv class, design a bold outfit, or stage a living-room karaoke session. Sun-soaked activities (like morning walks or basking by a window) can replenish your fiery spirit.\nCommunication Tip: Say, \"I'd love to share something I'm proud of—will you celebrate with me?\" to invite support while honoring your need for acknowledgment.",
        "closing_affirmation": "Your warmth is a beacon—it courageously lights up dark corners and reminds others to embrace life's drama. Celebrate your radiant heart, but remember: even the sun sets to recharge. Your worth isn't measured by applause; it's woven into the love you give freely. Shine bright, but let yourself rest in the soft glow of being enough."
    },
    
    "Virgo": {
        "traits": "Analytical, Nurturing, Methodical",
        "explanation": "Your Virgo Moon processes emotions through practicality and service. Feelings are often filtered through a need for order and clarity—you express care by problem-solving, attending to details, and creating stability for yourself and others.",
        "emotional_strengths": "Inner Gifts: You excel at transforming chaos into calm through meticulous planning and thoughtful gestures. Your discernment helps you offer precise support, while your humility makes you a steadfast ally. For example, when a friend is overwhelmed, you might quietly organize their pantry or draft a step-by-step plan to tackle their stress. Recharge by immersing yourself in purposeful tasks, like baking a nourishing meal or refining a personal budget, to restore your sense of control.",
        "emotional_challenges": "Growth Areas: Overthinking emotions or harsh self-criticism can lead to anxiety or perfectionism. You might dwell on a minor misstep, like an imperfect conversation, replaying it to find \"flaws.\" Tip: Practice \"balanced acceptance\"—set a 5-minute timer to address worries, then consciously release them. Journal three daily wins (e.g., \"I listened patiently\" or \"I tried something new\") to soften self-judgment.",
        "actionable_emotional_care": "Self-Care Rituals: Create a \"mindful tidy\" routine: clean a drawer while focusing on each movement as meditation. Use grounding practices like herbal tea blending or nature walks to connect with your senses. Try a \"worry checklist\" to methodically address concerns, then symbolically file it away.\nCommunication Tip: Say, \"I need to approach this step-by-step to feel clear,\" to help others honor your methodical nature.",
        "closing_affirmation": "Your meticulous care and quiet generosity are gifts—they bring order to chaos and comfort to those around you. Embrace your desire to improve, but remember: imperfection is part of being human. You are worthy of rest, kindness, and the same patience you offer others. Trust that you are enough, exactly as you are."
    },
    
    "Libra": {
        "traits": "Harmony-Seeking, Diplomatic, Relationship-Oriented",
        "explanation": "Your Libra Moon seeks emotional equilibrium through connection and beauty. Feelings are processed through a lens of fairness and partnership—you crave balance, mutual respect, and environments that soothe your senses.",
        "emotional_strengths": "Inner Gifts: You naturally mediate conflicts and uplift others with your grace and charm. Your ability to see multiple perspectives helps you craft compromises and diffuse tension. For example, during a group disagreement, you might propose a solution that honors everyone's needs while lightening the mood with humor. When stressed, curating a beautiful space—like arranging fresh flowers or playing ambient music—can restore your inner calm. Your affectionate nature makes loved ones feel deeply appreciated through small, thoughtful gestures.",
        "emotional_challenges": "Growth Areas: Avoiding conflict to preserve harmony can lead to suppressing your own needs or indecision. For instance, you might say \"I'm fine\" when hurt to keep the peace, or agonize over choices to avoid \"unbalancing\" relationships. Tip: Set a 2-minute timer to make low-stakes decisions (e.g., choosing a café), then reflect on how it felt. Practice gentle assertiveness by saying, \"I need to share something, even if it's uncomfortable.\"",
        "actionable_emotional_care": "Self-Care Rituals: Recharge through aesthetic nourishment—visit an art gallery, try a floral-scented bath, or wear colors that make you feel confident. Schedule \"mediation breaks\" by journaling with a pros/cons list to untangle emotional dilemmas.\nCommunication Tip: Say, \"Let's find a middle ground that works for both of us,\" to invite collaboration while honoring your needs.",
        "closing_affirmation": "Your desire for harmony is a gift—it bridges divides and creates beauty in a fragmented world. Honor your need for balance, but remember: your voice matters as much as others'. You are both the peacemaker and the peace; nurture yourself as deeply as you do the world around you."
    },
    
    "Scorpio": {
        "traits": "Intense, Loyal, Transformative, Perceptive",
        "explanation": "Your Scorpio Moon navigates emotions with profound depth and intuition. Feelings are experienced as all-consuming forces, driving a relentless pursuit of authenticity, trust, and rebirth through emotional honesty.",
        "emotional_strengths": "Inner Gifts: You possess an uncanny ability to see beneath the surface, offering unwavering loyalty and insight during crises. Your resilience transforms pain into power, making you a guiding light for others in turmoil. For example, when a friend faces betrayal, you might sense their unspoken hurt and create a safe space for them to heal, while gently encouraging their strength. Channeling emotions into creative or physical outlets—like writing, martial arts, or ritual practices—helps you reclaim control and clarity.",
        "emotional_challenges": "Growth Areas: A fear of vulnerability can lead to guarding your heart too fiercely or ruminating on past wounds. For instance, you might withdraw after a disagreement, interpreting it as a breach of trust. Tip: Practice \"emotional alchemy\"—write down fears or resentments, then ritually burn or bury them to symbolize release. Experiment with sharing one small vulnerability weekly to build trust in safe relationships.",
        "actionable_emotional_care": "Self-Care Rituals: Engage in shadow work journaling to explore hidden emotions, followed by a cleansing salt bath or walk in nature. Use mindfulness practices like candle-gazing or breathwork to ground intense feelings.\nCommunication Tip: Say, \"I need honesty and patience to feel secure,\" to help others understand your depth without feeling judged.",
        "closing_affirmation": "Your intensity is a superpower—it unearths truths, transforms pain, and forges unbreakable bonds. Honor your need for trust, but remember: softness is not weakness. You are both the fire that purifies and the phoenix that rises, endlessly resilient. Let your heart be a sanctuary, not a fortress."
    },
    
    "Sagittarius": {
        "traits": "Adventurous, Optimistic, Freedom-Seeking",
        "explanation": "Your Sagittarius Moon processes emotions through exploration and a hunger for meaning. Feelings are intertwined with curiosity and a need to grow—you seek joy, expansion, and the freedom to embrace life's grand adventure.",
        "emotional_strengths": "Inner Gifts: You reframe challenges as opportunities, inspiring others with your humor and unshakable optimism. Your spontaneity turns routine into discovery, and your philosophical nature helps you find purpose in hardship. For example, after a breakup, you might channel heartache into planning a solo trip or enroll in a course to reignite your sense of possibility. When overwhelmed, a brisk hike, laughter-filled conversation, or diving into a book about distant cultures can rekindle your spirit.",
        "emotional_challenges": "Growth Areas: Restlessness might lead to avoiding vulnerable emotions by chasing \"the next big thing.\" You could dismiss sadness with, \"I'll just move on,\" or struggle to commit to routines that nurture stability. Tip: Pause weekly to ask, \"What am I feeling beneath my optimism?\" Try free-writing for 5 minutes without judging or fixing the emotion—let it exist.",
        "actionable_emotional_care": "Self-Care Rituals: Feed your wanderlust through \"micro-adventures\"—try a new cuisine, stargaze, or take a day trip to an unfamiliar neighborhood. Use movement as meditation: archery, dance, or trail running can align your body and mind.\nCommunication Tip: Say, \"I need space to process, but I'll share insights when I return,\" to honor your exploratory nature while reassuring loved ones.",
        "closing_affirmation": "Your optimism is a beacon—it turns setbacks into stepping stones and reminds others to hope. Celebrate your boundless spirit, but remember: roots don't trap you; they ground your flight. You are the archer and the arrow—aim fearlessly, but let your heart rest in the joy of the journey."
    },
    
    "Capricorn": {
        "traits": "Resilient, Ambitious, Pragmatic",
        "explanation": "Your Capricorn Moon processes emotions through structure and purpose. Feelings are deeply tied to responsibility, achievement, and long-term security—you seek stability through patience, discipline, and tangible progress.",
        "emotional_strengths": "Inner Gifts: You thrive under pressure, offering steady support and practical solutions during crises. Your foresight helps you navigate challenges with strategic calm, while your loyalty builds unshakable trust. For example, when a loved one faces a setback, you might draft a step-by-step recovery plan or remind them of their past triumphs to reignite hope. Recharge by organizing a project, tending to a garden, or reviewing long-term goals to reaffirm your sense of control.",
        "emotional_challenges": "Growth Areas: Suppressing emotions to \"stay strong\" can lead to burnout or emotional detachment. You might dismiss stress with, \"I'll handle it later,\" only to feel isolated when overwhelmed. Tip: Schedule 10-minute \"emotional check-ins\" daily—sit quietly, name your feelings without judgment, and visualize releasing them like stones into a river.",
        "actionable_emotional_care": "Self-Care Rituals: Balance productivity with grounding rituals: try \"time-blocking\" self-care (e.g., 20 minutes for tea and reflection) or tactile activities like pottery or woodworking. Hike a mountain trail or climb stairs to symbolically \"ascend\" while reconnecting with your body.\nCommunication Tip: Say, \"I need practical support to feel secure,\" to invite help without framing it as vulnerability.",
        "closing_affirmation": "Your resilience is a fortress—it shelters those you love and builds legacies from perseverance. Honor your dedication, but remember: even mountains weather storms through flexibility. You are both the architect and the foundation—ambitious, enduring, and worthy of gentleness. Let your heart rest in the knowledge that you are enough, exactly as you are."
    },
    
    "Aquarius": {
        "traits": "Innovative, Independent, Visionary",
        "explanation": "Your Aquarius Moon processes emotions through intellect and a desire for collective connection. Feelings are often linked to ideals, freedom, and the bigger picture—you seek emotional fulfillment through innovation, social progress, and honoring your unique perspective.",
        "emotional_strengths": "Inner Gifts: You approach emotions with objectivity, offering inventive solutions during crises. Your ability to detach helps you advocate for fairness and inspire change. For example, when faced with personal stress, you might channel energy into organizing a community project or brainstorming futuristic ideas to reframe the issue. Recharge by engaging in group activities, stargazing, or experimenting with technology—anything that fuels your sense of possibility.",
        "emotional_challenges": "Growth Areas: Over-reliance on logic can lead to dismissing personal emotions or seeming aloof in intimate relationships. You might deflect vulnerability with humor or focus solely on \"fixing\" problems instead of sitting with feelings. Tip: Practice \"micro-connection\"—share one personal emotion with a trusted friend weekly, or write a letter to your future self exploring a fear without judgment.",
        "actionable_emotional_care": "Self-Care Rituals: Balance solitude and collaboration: join a cause you care about, try a digital detox weekend, or create art with recycled materials. Use \"future-self journaling\" to envision how your emotions might evolve.\nCommunication Tip: Say, \"I need space to process, but I'm committed to understanding your perspective,\" to honor your independence while nurturing trust.",
        "closing_affirmation": "Your visionary heart is a catalyst—it dares to imagine a better world and empowers others to think boldly. Celebrate your uniqueness, but remember: even constellations need individual stars to shine. You are both the innovator and the dreamer—let your mind soar, but let your heart whisper its needs. Trust that connection and freedom can coexist."
    },
    
    "Pisces": {
        "traits": "Empathetic, Imaginative, Fluid",
        "explanation": "Your Pisces Moon feels emotions as a boundless ocean—deep, intuitive, and interconnected with the unseen. You process feelings through creativity, compassion, and a longing to merge with the world's beauty and pain.",
        "emotional_strengths": "Inner Gifts: You offer unconditional acceptance, sensing unspoken emotions and transforming them into art, music, or acts of kindness. Your imagination helps others see magic in the mundane. For example, you might comfort a grieving friend by painting them a symbolic gift or write poetry to make sense of your own heartache. When overwhelmed, losing yourself in music, nature walks, or volunteering for a cause can restore your sense of purpose.",
        "emotional_challenges": "Growth Areas: Absorbing others' energy or escaping into fantasy can blur your emotional boundaries. You might numb stress through binge-watching, procrastination, or avoiding tough conversations. Tip: Practice \"energetic shielding\"—visualize a glowing bubble around you after social interactions. Try a \"reality check\" ritual: write down one actionable step to address a problem, then let yourself daydream guilt-free for 10 minutes.",
        "actionable_emotional_care": "Self-Care Rituals: Recharge through water-based healing: take moonlit baths with lavender oil, listen to ocean sounds, or sketch flowing patterns. Use \"dream journaling\" to decode emotional themes in your subconscious. Create a sacred space with soft lighting and inspiring art for daily reflection.\nCommunication Tip: Say, \"I feel things deeply—I need gentle honesty,\" to invite understanding without oversharing.",
        "closing_affirmation": "Your sensitivity is a rare gift—it heals, connects, and reveals worlds others overlook. Honor your fluid heart, but remember: even the ocean has shores. You are both the mystic and the guide—trust your intuition, but let your feet touch the earth. Your compassion is limitless, and so is your strength."
    }
}

def get_moon_sign_description(sign_name):
    """
    Retrieves the description for a specific Moon sign.
    
    Parameters:
    - sign_name (str): Name of the zodiac sign (e.g., "Aries", "Taurus")
    
    Returns:
    - dict: Formatted Moon sign description or None if not found
    """
    # Normalize the sign name (capitalize first letter)
    sign_name = sign_name.capitalize()
    
    # Get the description
    description = MOON_SIGN_DESCRIPTIONS.get(sign_name)
    if not description:
        return None
        
    # Format the traits as a list of dictionaries
    traits_list = [{"trait": trait.strip()} for trait in description["traits"].split(", ")]
    
    # Format the response
    return {
        "title": f"Moon in {sign_name}",
        "planet": "Moon",
        "sign": sign_name,
        "traits": traits_list,
        "explanation": description["explanation"],
        "emotional_strengths": description["emotional_strengths"],
        "emotional_challenges": description["emotional_challenges"],
        "actionable_emotional_care": description["actionable_emotional_care"],
        "closing_affirmation": description["closing_affirmation"]
    } 